<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>ACC Converter â€” Actalithic</title>
<link rel="icon" type="image/png" href="https://i.ibb.co/DfYLtMhQ/favicon.png">
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
<script>(function(){var s=localStorage.getItem('llm-theme');document.documentElement.setAttribute('data-theme',s||'dark');})()</script>
<style>
.converter-wrap{
  width:100%;max-width:760px;margin:0 auto;
  padding:2rem 1.25rem 3rem;
  display:flex;flex-direction:column;gap:1.75rem;
}
@media(min-width:600px){.converter-wrap{padding:2.5rem 1.75rem 3.5rem}}
@media(min-width:840px){.converter-wrap{padding:3rem 2rem 4rem}}

.conv-card{
  background:var(--bg2);border:1px solid var(--border);
  border-radius:10px;padding:1.5rem 1.75rem;
  display:flex;flex-direction:column;gap:1.1rem;
}
.conv-card-title{
  font-family:'Syne',sans-serif;font-weight:700;font-size:1rem;
  color:var(--ink);display:flex;align-items:center;gap:.55rem;
}
.conv-card-title .material-icons-round{font-size:18px;color:var(--purple)}
.conv-card-sub{font-size:.72rem;color:var(--muted);line-height:1.7;margin-top:-.25rem}

/* Source tabs */
.source-tabs{
  display:flex;border:1px solid var(--border);border-radius:6px;overflow:hidden;
  background:var(--bg);
}
.source-tab{
  flex:1;padding:.6rem .75rem;font-family:'DM Mono',monospace;font-size:.72rem;
  background:transparent;border:none;color:var(--muted);cursor:pointer;
  transition:all .15s;display:flex;align-items:center;justify-content:center;gap:.4rem;
  border-right:1px solid var(--border);
}
.source-tab:last-child{border-right:none}
.source-tab.active{background:var(--ink);color:var(--accent-inv)}
.source-tab .material-icons-round{font-size:14px}

/* HF catalogue */
.hf-catalogue-label{font-size:.62rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
.hf-model-grid{
  display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:.6rem;
}
.hf-model-card{
  border:1.5px solid var(--border);border-radius:8px;padding:.9rem 1rem;
  cursor:pointer;transition:all .15s;background:var(--bg);
  display:flex;flex-direction:column;gap:.35rem;
  -webkit-tap-highlight-color:transparent;
}
.hf-model-card:hover{border-color:var(--purple);background:var(--purple-bg)}
.hf-model-card.selected{border-color:var(--purple);background:var(--purple-bg)}
.hf-model-card.selected .hf-card-name{color:var(--purple)}
.hf-card-name{font-size:.85rem;color:var(--ink);font-weight:500;line-height:1.3}
.hf-card-meta{font-size:.6rem;color:var(--muted);display:flex;align-items:center;gap:.4rem;flex-wrap:wrap}
.hf-card-tag{
  font-size:.52rem;padding:1px 6px;border-radius:20px;
  border:1px solid var(--border);color:var(--muted);background:var(--bg3);
  white-space:nowrap;
}
.hf-card-tag.acc{border-color:var(--purple);color:var(--purple);background:var(--purple-bg)}
.hf-card-tag.q4{border-color:var(--green-dim);color:var(--green);background:var(--green-bg)}

.hf-custom-row{display:flex;gap:.5rem;align-items:flex-end}
.hf-custom-input{
  flex:1;font-family:'DM Mono',monospace;font-size:.78rem;
  padding:.55rem .85rem;border-radius:6px;
  background:var(--bg);border:1px solid var(--border2);color:var(--ink);
  outline:none;transition:border-color .15s;
}
.hf-custom-input:focus{border-color:var(--purple);box-shadow:0 0 0 2px rgba(102,51,187,.12)}
.hf-load-btn{
  font-family:'Syne',sans-serif;font-weight:700;font-size:.75rem;
  padding:.55rem 1.1rem;border-radius:6px;border:none;cursor:pointer;
  background:var(--purple);color:#fff;display:flex;align-items:center;gap:.35rem;
  white-space:nowrap;transition:all .15s;flex-shrink:0;
}
.hf-load-btn:hover{opacity:.85;transform:translateY(-1px)}
.hf-load-btn:disabled{opacity:.4;cursor:not-allowed;transform:none}
.hf-load-btn .material-icons-round{font-size:15px}

.hf-status{
  font-size:.7rem;color:var(--muted);display:none;
  align-items:center;gap:.5rem;
  padding:.65rem .85rem;background:var(--bg);border:1px solid var(--border);border-radius:6px;
  line-height:1.6;
}
.hf-status.visible{display:flex}
.hf-status .material-icons-round{font-size:15px;flex-shrink:0}
.hf-status.ok{color:var(--green);border-color:var(--green-dim);background:var(--green-bg)}
.hf-status.err{color:var(--red);border-color:var(--red-dim);background:var(--red-bg)}
.hf-dl-progress{width:100%;height:3px;background:var(--border);border-radius:2px;overflow:hidden;margin-top:.35rem}
.hf-dl-fill{height:100%;background:var(--purple);width:0%;transition:width .3s}

/* File drop */
.drop-zone{
  border:2px dashed var(--border2);border-radius:8px;
  padding:2.75rem 1rem;text-align:center;
  cursor:pointer;transition:all .2s;background:var(--bg);
  display:flex;flex-direction:column;align-items:center;gap:.65rem;
}
.drop-zone:hover,.drop-zone.drag-over{border-color:var(--purple);background:var(--purple-bg)}
.drop-zone .material-icons-round{font-size:2.5rem;color:var(--muted)}
.drop-zone.drag-over .material-icons-round{color:var(--purple)}
.drop-label{font-size:.82rem;color:var(--muted)}
.drop-hint{font-size:.65rem;color:var(--border2)}
.drop-file-name{
  font-size:.75rem;color:var(--green);font-weight:500;
  display:flex;align-items:center;gap:.35rem;
  padding:.4rem .75rem;background:var(--green-bg);
  border-radius:20px;border:1px solid var(--green-dim);
}

/* Presets */
.preset-grid{
  display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:.65rem;
}
.preset-card{
  border:1.5px solid var(--border);border-radius:8px;padding:1rem 1.1rem;
  cursor:pointer;transition:all .15s;background:var(--bg);
  display:flex;flex-direction:column;gap:.35rem;
  -webkit-tap-highlight-color:transparent;
}
.preset-card:hover{border-color:var(--purple);background:var(--purple-bg)}
.preset-card.active{border-color:var(--purple);background:var(--purple-bg)}
.preset-card.active .preset-name{color:var(--purple)}
.preset-name{font-family:'Syne',sans-serif;font-weight:700;font-size:.88rem;color:var(--ink)}
.preset-desc{font-size:.65rem;color:var(--muted);line-height:1.6}
.preset-tags{display:flex;gap:.35rem;flex-wrap:wrap;margin-top:.25rem}
.preset-tag{
  font-size:.5rem;padding:1px 6px;border-radius:20px;
  border:1px solid var(--border);color:var(--muted);background:var(--bg3);
}
.preset-tag.green{border-color:var(--green-dim);color:var(--green);background:var(--green-bg)}
.preset-tag.purple{border-color:var(--purple-dim);color:var(--purple);background:var(--purple-bg)}
.preset-tag.blue{border-color:var(--blue);color:var(--blue);background:var(--blue-bg)}
.preset-tag.amber{border-color:var(--amber-dim);color:var(--amber);background:var(--amber-bg)}

.speed-estimate{
  display:none;align-items:center;gap:.6rem;
  padding:.65rem 1rem;background:var(--green-bg);
  border:1px solid var(--green-dim);border-radius:6px;
  font-size:.7rem;color:var(--green);line-height:1.6;
}
.speed-estimate.visible{display:flex}
.speed-estimate .material-icons-round{font-size:16px;flex-shrink:0}

/* Expert */
.expert-toggle{
  font-size:.68rem;color:var(--muted);cursor:pointer;
  display:flex;align-items:center;gap:.35rem;
  transition:color .15s;user-select:none;width:fit-content;
}
.expert-toggle:hover{color:var(--ink)}
.expert-toggle .material-icons-round.chevron{font-size:14px;transition:transform .2s}
.expert-toggle.open .material-icons-round.chevron{transform:rotate(180deg)}
.expert-panel{display:none;flex-direction:column;gap:1rem;padding-top:.25rem}
.expert-panel.open{display:flex}

.options-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
@media(max-width:480px){.options-grid{grid-template-columns:1fr}}
.opt-field{display:flex;flex-direction:column;gap:.4rem}
.opt-label{font-size:.62rem;color:var(--muted);text-transform:uppercase;letter-spacing:.08em}
.opt-select,.opt-input{
  font-family:'DM Mono',monospace;font-size:.78rem;
  padding:.55rem .85rem;border-radius:6px;
  background:var(--bg);border:1px solid var(--border2);color:var(--ink);
  outline:none;transition:border-color .15s;
}
.opt-select:focus,.opt-input:focus{border-color:var(--purple)}

.tok-drop{
  border:1.5px dashed var(--border);border-radius:6px;
  padding:.65rem .85rem;font-size:.72rem;color:var(--muted);
  cursor:pointer;transition:all .15s;background:var(--bg);
  display:flex;align-items:center;gap:.4rem;
}
.tok-drop:hover{border-color:var(--purple);color:var(--purple);background:var(--purple-bg)}
.tok-drop.loaded{border-color:var(--green);color:var(--green);background:var(--green-bg)}

.opt-metrics{
  display:flex;gap:.45rem;flex-wrap:wrap;padding:.6rem .85rem;
  background:var(--bg3);border-radius:6px;border:1px solid var(--border);font-size:.65rem;
}
.opt-metric{
  display:flex;align-items:center;gap:.3rem;color:var(--muted);
  padding:2px 8px;border-radius:20px;border:1px solid var(--border);background:var(--bg);
  white-space:nowrap;
}
.opt-metric.ok{color:var(--green);border-color:var(--green-dim);background:var(--green-bg)}
.opt-metric.hi{color:var(--purple);border-color:var(--purple-dim);background:var(--purple-bg)}
.opt-metric .material-icons-round{font-size:11px}

/* Convert button */
.conv-btn{
  width:100%;padding:1rem;
  font-family:'Syne',sans-serif;font-weight:700;font-size:.92rem;
  letter-spacing:.04em;border-radius:8px;
  background:var(--accent);color:var(--accent-inv);border:none;
  cursor:pointer;transition:all .18s;
  display:flex;align-items:center;justify-content:center;gap:.5rem;min-height:52px;
}
.conv-btn:hover{opacity:.88;transform:translateY(-2px);box-shadow:0 6px 24px var(--shadow-lg)}
.conv-btn:active{transform:scale(.97);box-shadow:none}
.conv-btn:disabled{opacity:.4;cursor:not-allowed;transform:none;box-shadow:none}

/* Progress */
.progress-section{display:none}
.progress-section.visible{display:block}
.progress-log{
  font-size:.65rem;color:var(--muted);
  max-height:160px;overflow-y:auto;
  border:1px solid var(--border);border-radius:6px;
  padding:.6rem .85rem;background:var(--bg);
  display:flex;flex-direction:column;gap:.2rem;margin-top:.85rem;
}
.log-line{display:flex;gap:.5rem;align-items:baseline}
.log-pct{color:var(--purple);flex-shrink:0;width:3.2em;text-align:right;font-weight:500}
.log-msg{color:var(--ink2);line-height:1.5}

/* Results */
.result-section{display:none}
.result-section.visible{display:flex;flex-direction:column;gap:.75rem}
.result-stat{
  display:flex;justify-content:space-between;align-items:center;
  padding:.55rem 0;border-bottom:1px solid var(--border);font-size:.75rem;
}
.result-stat:last-of-type{border-bottom:none}
.result-stat-label{color:var(--muted)}
.result-stat-val{color:var(--ink);font-weight:500}
.result-stat-val.green{color:var(--green)}
.result-stat-val.purple{color:var(--purple)}

.action-row{display:flex;gap:.65rem;flex-wrap:wrap;margin-top:.25rem}
.action-btn{
  flex:1;min-width:150px;padding:.8rem .5rem;
  font-family:'Syne',sans-serif;font-weight:700;font-size:.78rem;
  border-radius:8px;border:1.5px solid var(--border2);
  background:var(--bg2);color:var(--ink);cursor:pointer;
  display:flex;align-items:center;justify-content:center;gap:.4rem;transition:all .15s;
}
.action-btn:hover{border-color:var(--purple);color:var(--purple);background:var(--purple-bg)}
.action-btn.primary{background:var(--accent);color:var(--accent-inv);border-color:var(--accent)}
.action-btn.primary:hover{opacity:.85;border-color:var(--accent)}
.action-btn .material-icons-round{font-size:16px}

.conv-info{
  background:var(--blue-bg);border:1px solid var(--blue);
  border-radius:8px;padding:.8rem 1rem;font-size:.7rem;
  color:var(--blue);display:flex;gap:.55rem;align-items:flex-start;line-height:1.7;
}
.conv-info .material-icons-round{font-size:15px;flex-shrink:0;margin-top:1px}

.arch-badge{
  font-size:.6rem;padding:2px 7px;border-radius:20px;
  border:1px solid var(--purple);color:var(--purple);
  background:var(--purple-bg);font-weight:500;display:inline-block;margin-left:.4rem;
}
.conv-page-title{
  font-family:'Syne',sans-serif;font-weight:800;
  font-size:clamp(1.5rem,6vw,2.2rem);letter-spacing:-.04em;
  color:var(--ink);line-height:1.1;
}
.conv-page-title span{color:var(--purple)}
.conv-page-sub{
  font-size:.78rem;color:var(--muted);line-height:1.8;margin-top:.5rem;max-width:540px;
}
</style>
</head>
<body>
<!-- â”€â”€ HEADER â”€â”€ -->
<header>
  <div class="header-brand">
    <img class="logo-img logo-light" src="https://i.ibb.co/mV4rQV7B/Chat-GPT-Image-18-Feb-2026-08-42-07.png" alt="LocalLLM by Actalithic">
    <img class="logo-img logo-dark"  src="https://i.ibb.co/tpSTrg7Z/whitelogo.png" alt="LocalLLM by Actalithic">
  </div>
  <div class="header-right">
    <a class="icon-btn" href="index.html" title="LocalLLM"><span class="material-icons-round">home</span></a>
    <a class="icon-btn bsky" href="https://bsky.app/profile/actalithic.bsky.social" target="_blank" rel="noopener" title="Bluesky">
      <svg viewBox="0 0 600 530" xmlns="http://www.w3.org/2000/svg"><path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z" fill="currentColor"/></svg>
    </a>
    <button class="icon-btn" onclick="toggleTheme()" title="Toggle theme">
      <span class="material-icons-round" id="themeIcon">light_mode</span>
    </button>
  </div>
</header>

<div class="converter-wrap">

  <div>
    <div class="conv-page-title">.acc <span>Converter</span></div>
    <div class="conv-page-sub">
      Convert models to Actalithic's browser-native format â€” entirely in your browser. Pick a preset from HuggingFace or upload your own safetensors. Nothing leaves your device.
    </div>
  </div>

  <!-- â•â• STEP 1: Source â•â• -->
  <div class="conv-card">
    <div class="conv-card-title">
      <span class="material-icons-round">input</span>
      1 â€” Choose model source
    </div>

    <div class="source-tabs">
      <button class="source-tab active" id="tabHF" onclick="setSourceMode('hf')">
        <span class="material-icons-round">cloud_download</span> HuggingFace
      </button>
      <button class="source-tab" id="tabFile" onclick="setSourceMode('file')">
        <span class="material-icons-round">upload_file</span> Upload file
      </button>
    </div>

    <!-- HF panel -->
    <div id="hfPanel" style="display:flex;flex-direction:column;gap:.9rem">
      <div class="hf-catalogue-label">Popular models â€” click to select</div>
      <div class="hf-model-grid" id="hfModelGrid"></div>

      <div style="font-size:.63rem;color:var(--muted)">Or enter any HuggingFace repo:</div>
      <div class="hf-custom-row">
        <input class="hf-custom-input" id="hfRepoInput" type="text"
          placeholder="e.g. Qwen/Qwen2.5-7B-Instruct" oninput="onHFRepoInput()" />
        <button class="hf-load-btn" id="hfLoadBtn" onclick="startHFDownload()">
          <span class="material-icons-round">download</span> Load from HF
        </button>
      </div>

      <div class="hf-status" id="hfStatus">
        <div style="flex:1">
          <div style="display:flex;align-items:center;gap:.4rem">
            <span class="material-icons-round" id="hfStatusIcon" style="font-size:15px">hourglass_empty</span>
            <span id="hfStatusText">Preparingâ€¦</span>
          </div>
          <div class="hf-dl-progress" id="hfDlProgress" style="display:none">
            <div class="hf-dl-fill" id="hfDlFill"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- File panel -->
    <div id="filePanel" style="display:none">
      <div class="drop-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
        <span class="material-icons-round">cloud_upload</span>
        <div class="drop-label">Drop <code>.safetensors</code> file here</div>
        <div class="drop-hint">or click to browse â€” single file only</div>
        <div class="drop-file-name" id="dropFileName" style="display:none">
          <span class="material-icons-round" style="font-size:14px">check_circle</span>
          <span id="dropFileNameText"></span>
        </div>
      </div>
      <input type="file" id="fileInput" accept=".safetensors" style="display:none">
    </div>
  </div>

  <!-- â•â• STEP 2: Preset â•â• -->
  <div class="conv-card">
    <div class="conv-card-title">
      <span class="material-icons-round">auto_fix_high</span>
      2 â€” Optimization preset
    </div>
    <div class="conv-card-sub">
      Presets auto-tune quantization, block calibration, and shard layout for your target use case.
    </div>

    <div class="preset-grid" id="presetGrid"></div>

    <div class="speed-estimate" id="speedEstimate">
      <span class="material-icons-round">bolt</span>
      <div id="speedEstimateText"></div>
    </div>

    <!-- Expert options -->
    <div style="display:flex;flex-direction:column;gap:.75rem">
      <div class="expert-toggle" id="expertToggle" onclick="toggleExpert()">
        <span class="material-icons-round chevron">expand_more</span>
        <span class="material-icons-round" style="font-size:13px">tune</span>
        Expert options
      </div>
      <div class="expert-panel" id="expertPanel">
        <div class="options-grid">
          <div class="opt-field">
            <div class="opt-label">Quantization</div>
            <select class="opt-select" id="quantMode" onchange="onExpertChange()">
              <option value="q4" selected>Q4 â€” 4-bit (fastest Â· smallest)</option>
              <option value="q8">Q8 â€” 8-bit (balanced quality)</option>
              <option value="f16">F16 â€” half precision</option>
              <option value="f32">F32 â€” full precision</option>
            </select>
          </div>
          <div class="opt-field">
            <div class="opt-label">Shard size</div>
            <select class="opt-select" id="shardSize" onchange="onExpertChange()">
              <option value="67108864">64 MB</option>
              <option value="134217728">128 MB</option>
              <option value="268435456">256 MB</option>
              <option value="536870912" selected>512 MB (recommended)</option>
              <option value="1073741824">1 GB (fastest load)</option>
            </select>
          </div>
          <div class="opt-field">
            <div class="opt-label">Output model name</div>
            <input class="opt-input" id="modelName" type="text" placeholder="my-model" value="my-model">
          </div>
          <div class="opt-field">
            <div class="opt-label">Arch override</div>
            <select class="opt-select" id="archOverride">
              <option value="">Auto-detect</option>
              <option value="llama">LLaMA / LLaMA 3</option>
              <option value="mistral">Mistral</option>
              <option value="phi">Phi</option>
              <option value="gemma">Gemma</option>
            </select>
          </div>
        </div>

        <div>
          <div class="opt-label" style="margin-bottom:.4rem">Tokenizer (auto-fetched for HF models)</div>
          <div class="tok-drop" id="tokDrop" onclick="document.getElementById('tokInput').click()">
            <span class="material-icons-round" style="font-size:16px">token</span>
            <span id="tokDropText">Drop tokenizer.json or click to browse</span>
          </div>
          <input type="file" id="tokInput" accept=".json" style="display:none">
        </div>

        <div class="opt-metrics" id="optMetrics">
          <span style="color:var(--muted);font-size:.63rem;margin-right:.2rem">Config:</span>
          <span class="opt-metric" id="metricQuant"><span class="material-icons-round">compress</span>â€”</span>
          <span class="opt-metric" id="metricShard"><span class="material-icons-round">storage</span>â€”</span>
          <span class="opt-metric" id="metricSpeed"><span class="material-icons-round">speed</span>â€”</span>
          <span class="opt-metric" id="metricAccuracy"><span class="material-icons-round">analytics</span>â€”</span>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â• STEP 3: Convert â•â• -->
  <div class="conv-card">
    <div class="conv-card-title">
      <span class="material-icons-round">bolt</span>
      3 â€” Convert &amp; export
    </div>

    <div class="progress-section" id="progressSection">
      <div class="progress-track" style="margin-bottom:.55rem">
        <div class="progress-fill" id="convProgressFill" style="width:0%"></div>
      </div>
      <div class="progress-row">
        <div class="progress-status" id="convStatus">Startingâ€¦</div>
        <div class="progress-label" id="convPct">0%</div>
      </div>
      <div class="progress-log" id="progressLog"></div>
    </div>

    <div class="result-section" id="resultSection">
      <div class="result-stat">
        <span class="result-stat-label">Architecture</span>
        <span class="result-stat-val" id="resArch">â€”</span>
      </div>
      <div class="result-stat">
        <span class="result-stat-label">Tensors converted</span>
        <span class="result-stat-val" id="resTensors">â€”</span>
      </div>
      <div class="result-stat">
        <span class="result-stat-label">Shards created</span>
        <span class="result-stat-val" id="resShards">â€”</span>
      </div>
      <div class="result-stat">
        <span class="result-stat-label">Quantization</span>
        <span class="result-stat-val purple" id="resQuant">â€”</span>
      </div>
      <div class="result-stat">
        <span class="result-stat-label">Total output size</span>
        <span class="result-stat-val green" id="resSize">â€”</span>
      </div>
      <div class="result-stat" id="resSpeedRow" style="display:none">
        <span class="result-stat-label">Expected inference speed</span>
        <span class="result-stat-val green" id="resSpeed">â€”</span>
      </div>
      <div class="action-row">
        <button class="action-btn primary" onclick="downloadModel()">
          <span class="material-icons-round">download</span>
          Download .acc folder
        </button>
        <button class="action-btn" onclick="saveToOPFSModel()" id="opfsBtn">
          <span class="material-icons-round">save</span>
          Save to browser cache
        </button>
      </div>
      <div style="font-size:.6rem;color:var(--muted);line-height:1.7">
        <strong>Download</strong> saves to a folder via the FileSystem Access API.<br>
        <strong>Browser cache</strong> uses OPFS â€” instant load on next session, no re-download.
      </div>
    </div>

    <button class="conv-btn" id="convBtn" onclick="startConversion()">
      <span class="material-icons-round">auto_fix_high</span>
      Convert to .acc
    </button>
  </div>

  <div class="conv-info">
    <span class="material-icons-round">lock</span>
    <span>100% browser-native. No data is uploaded to any server. All conversion, quantization and caching happens entirely on your device.</span>
  </div>

</div>

<!-- â”€â”€ FOOTER â”€â”€ -->
<footer class="site-footer">
  <div class="footer-inner">
    <img class="footer-logo footer-logo-light"
      src="https://i.ibb.co/mV4rQV7B/Chat-GPT-Image-18-Feb-2026-08-42-07.png" alt="LocalLLM by Actalithic">
    <img class="footer-logo footer-logo-dark"
      src="https://i.ibb.co/tpSTrg7Z/whitelogo.png" alt="LocalLLM by Actalithic">
    <span class="footer-copy">Â© 2026 Actalithic Â· LocalLLM</span>
    <div class="footer-links">
      <a class="footer-link" href="index.html">LocalLLM</a>
      <span class="footer-sep">Â·</span>
      <a class="footer-link" href="blog.html">Blog</a>
      <span class="footer-sep">Â·</span>
      <a class="footer-link" href="https://bsky.app/profile/actalithic.bsky.social" target="_blank" rel="noopener">
        <svg viewBox="0 0 600 530" xmlns="http://www.w3.org/2000/svg"><path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z" fill="currentColor"/></svg>
        Bluesky
      </a>
      <span class="footer-sep">Â·</span>
      <a class="footer-link" href="https://github.com/actalithic" target="_blank" rel="noopener">GitHub</a>
    </div>
  </div>
</footer>

<script type="module">
import { convertSafetensors, downloadBundle, saveToOPFS } from './js/acc-converter.js';
import { toggleTheme } from './js/theme.js';
window.toggleTheme = toggleTheme;

// â”€â”€ Theme â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function applyLogos() {
  const d = document.documentElement.getAttribute('data-theme') === 'dark';
  document.querySelectorAll('.logo-light,.footer-logo-light').forEach(e => e.style.display = d ? 'none' : 'block');
  document.querySelectorAll('.logo-dark,.footer-logo-dark').forEach(e =>  e.style.display = d ? 'block' : 'none');
  const ic = document.getElementById('themeIcon');
  if (ic) ic.textContent = d ? 'light_mode' : 'dark_mode';
}
applyLogos();
new MutationObserver(applyLogos).observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme'] });

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let _sourceMode   = 'hf';
let _file         = null;
let _hfBuffer     = null;
let _tokContent   = null;
let _bundle       = null;
let _kernelsSrc   = null;
let _activePreset = 'extreme';
let _hfSelModel   = null;

fetch('./webgpu/kernels.wgsl').then(r => r.text()).then(t => { _kernelsSrc = t; }).catch(() => {});

// â”€â”€ HF catalogue â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const HF_MODELS = [
  { id:'google/gemma-3-4b-it',             name:'Gemma 3 4B',      creator:'Google',     size:'~3.3 GB', arch:'gemma',   file:'model.safetensors', tok:'tokenizer.json', tags:['light','multilingual'],    desc:'Fast & multilingual.' },
  { id:'Qwen/Qwen2.5-7B-Instruct',         name:'Qwen 2.5 7B',     creator:'Alibaba',    size:'~4.5 GB', arch:'llama',   file:'model.safetensors', tok:'tokenizer.json', tags:['coding','math'],            desc:'Best coding & math at 7B.' },
  { id:'mistralai/Mistral-7B-Instruct-v0.3',name:'Mistral 7B v0.3',creator:'Mistral AI', size:'~4 GB',   arch:'mistral', file:'model.safetensors', tok:'tokenizer.json', tags:['general','fast'],           desc:'Reliable all-rounder.' },
  { id:'meta-llama/Llama-3.2-3B-Instruct', name:'Llama 3.2 3B',    creator:'Meta',       size:'~2 GB',   arch:'llama',   file:'model.safetensors', tok:'tokenizer.json', tags:['light','phone-friendly'],   desc:'Ultra-light. Runs on phones.' },
  { id:'microsoft/phi-4-mini-instruct',     name:'Phi-4 Mini',      creator:'Microsoft',  size:'~2.5 GB', arch:'phi',     file:'model.safetensors', tok:'tokenizer.json', tags:['reasoning','compact'],      desc:'Strong reasoning, compact.' },
  { id:'deepseek-ai/DeepSeek-R1-Distill-Llama-8B', name:'DeepSeek R1 8B', creator:'DeepSeek', size:'~5 GB', arch:'llama', file:'model.safetensors', tok:'tokenizer.json', tags:['reasoning','thinking'], desc:'Chain-of-thought reasoning.' },
];

function buildHFGrid() {
  document.getElementById('hfModelGrid').innerHTML = HF_MODELS.map(m => `
    <div class="hf-model-card" data-hfid="${m.id}" onclick="selectHFModel('${m.id}')">
      <div class="hf-card-name">${m.name}</div>
      <div class="hf-card-meta"><span>${m.creator}</span><span>Â·</span><span>${m.size}</span></div>
      <div class="hf-card-meta" style="margin-top:.15rem">
        ${m.tags.map(t=>`<span class="hf-card-tag">${t}</span>`).join('')}
        <span class="hf-card-tag acc">ACC-ready</span>
        <span class="hf-card-tag q4">Q4 rec.</span>
      </div>
      <div style="font-size:.62rem;color:var(--muted);margin-top:.3rem;line-height:1.5">${m.desc}</div>
    </div>
  `).join('');
}
buildHFGrid();

window.selectHFModel = function(id) {
  _hfSelModel = HF_MODELS.find(m => m.id === id) || null;
  document.querySelectorAll('.hf-model-card').forEach(c => c.classList.toggle('selected', c.dataset.hfid === id));
  if (_hfSelModel) {
    document.getElementById('hfRepoInput').value = id;
    document.getElementById('modelName').value   = id.split('/').pop().toLowerCase().replace(/[^a-z0-9-_]/g,'-');
    if (_hfSelModel.arch) document.getElementById('archOverride').value = _hfSelModel.arch;
  }
};
window.onHFRepoInput = function() {
  document.querySelectorAll('.hf-model-card').forEach(c => c.classList.remove('selected'));
  _hfSelModel = null;
};

// â”€â”€ Presets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PRESETS = {
  extreme: {
    label:'âš¡ Extreme Speed', quant:'q4', shardBytes:536870912,
    speedEst:'15â€“80 tok/s depending on device',
    accuracyNote:'Actalithic ACC-optimised Q4 Â· ~98% quality vs F32 Â· recommended for all ACC models',
    tags:[['âš¡ Fastest','green'],['Q4','purple'],['ACC-optimised','blue']],
    desc:'Actalithic-optimised Q4 with per-block calibration â€” maximum inference speed. Recommended for all ACC models.',
  },
  balanced: {
    label:'âš– Balanced', quant:'q8', shardBytes:268435456,
    speedEst:'8â€“40 tok/s depending on device',
    accuracyNote:'Q8 symmetric blocks Â· ~99.5% quality vs F32',
    tags:[['Balanced','amber'],['Q8','purple'],['High fidelity','blue']],
    desc:'Q8 quantization â€” higher fidelity at moderate speed. Best for precise numerical tasks.',
  },
  quality: {
    label:'ğŸ¯ Max Quality', quant:'f16', shardBytes:268435456,
    speedEst:'5â€“20 tok/s depending on device',
    accuracyNote:'F16 lossless Â· ~100% quality',
    tags:[['Near-lossless','green'],['F16','purple'],['2Ã— size','amber']],
    desc:'F16 half-precision â€” near-lossless accuracy when correctness matters most.',
  },
  dev: {
    label:'ğŸ”§ Dev / Debug', quant:'f32', shardBytes:134217728,
    speedEst:'2â€“8 tok/s (large model)',
    accuracyNote:'F32 full precision Â· 4Ã— size vs Q4',
    tags:[['Full precision','green'],['F32','purple'],['Debug','blue']],
    desc:'F32 full precision with small 128 MB shards for easy debugging and inspection.',
  },
};

function buildPresets() {
  document.getElementById('presetGrid').innerHTML = Object.entries(PRESETS).map(([k,p]) => `
    <div class="preset-card ${k===_activePreset?'active':''}" data-preset="${k}" onclick="selectPreset('${k}')">
      <div class="preset-name">${p.label}</div>
      <div class="preset-desc">${p.desc}</div>
      <div class="preset-tags">${p.tags.map(([t,c])=>`<span class="preset-tag ${c}">${t}</span>`).join('')}</div>
    </div>
  `).join('');
}
buildPresets();

window.selectPreset = function(k) {
  _activePreset = k;
  const p = PRESETS[k];
  document.querySelectorAll('.preset-card').forEach(c => c.classList.toggle('active', c.dataset.preset === k));
  document.getElementById('quantMode').value = p.quant;
  document.getElementById('shardSize').value = String(p.shardBytes);
  document.getElementById('speedEstimateText').innerHTML =
    `<strong>${p.label}:</strong> ${p.speedEst} &nbsp;Â·&nbsp; ${p.accuracyNote}`;
  document.getElementById('speedEstimate').classList.add('visible');
  updateMetrics();
};
selectPreset('extreme');

function updateMetrics() {
  const q = document.getElementById('quantMode').value;
  const s = parseInt(document.getElementById('shardSize').value);
  const speedMap = { q4:'â˜…â˜…â˜…â˜…â˜… Extreme', q8:'â˜…â˜…â˜…â˜…â˜† Fast', f16:'â˜…â˜…â˜…â˜†â˜† Moderate', f32:'â˜…â˜…â˜†â˜†â˜† Slow' };
  const accMap   = { q4:'~98% accuracy', q8:'~99.5% accuracy', f16:'~100% accuracy', f32:'100% accuracy' };
  document.getElementById('metricQuant').innerHTML    = `<span class="material-icons-round">compress</span>${q.toUpperCase()}`;
  document.getElementById('metricShard').innerHTML    = `<span class="material-icons-round">storage</span>${Math.round(s/1024/1024)} MB shards`;
  document.getElementById('metricSpeed').innerHTML    = `<span class="material-icons-round">speed</span>${speedMap[q]}`;
  document.getElementById('metricAccuracy').innerHTML = `<span class="material-icons-round">analytics</span>${accMap[q]}`;
  document.getElementById('metricSpeed').className    = 'opt-metric' + (q==='q4'?' hi':q==='q8'?' ok':'');
}
window.onExpertChange = function() {
  updateMetrics();
  _activePreset = null;
  document.querySelectorAll('.preset-card').forEach(c => c.classList.remove('active'));
  document.getElementById('speedEstimate').classList.remove('visible');
};
window.toggleExpert = function() {
  document.getElementById('expertToggle').classList.toggle('open');
  document.getElementById('expertPanel').classList.toggle('open');
};

// â”€â”€ Source mode â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.setSourceMode = function(mode) {
  _sourceMode = mode;
  document.getElementById('tabHF').classList.toggle('active',   mode==='hf');
  document.getElementById('tabFile').classList.toggle('active',  mode==='file');
  document.getElementById('hfPanel').style.display   = mode==='hf'   ? 'flex' : 'none';
  document.getElementById('filePanel').style.display = mode==='file' ? 'block' : 'none';
};

// â”€â”€ HF download â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.startHFDownload = async function() {
  const repo = document.getElementById('hfRepoInput').value.trim();
  if (!repo) { showHFStatus('err','Please enter or select a HuggingFace repo.'); return; }
  const btn = document.getElementById('hfLoadBtn');
  btn.disabled = true; btn.innerHTML = '<span class="material-icons-round">hourglass_empty</span> Downloadingâ€¦';
  const model = _hfSelModel || { file:'model.safetensors', tok:'tokenizer.json' };
  const base  = `https://huggingface.co/${repo}/resolve/main`;
  showHFStatus('loading', `Downloading ${model.file}â€¦`, true);
  try {
    const resp = await fetch(`${base}/${model.file}`);
    if (!resp.ok) throw new Error(`HTTP ${resp.status} â€” check repo/file path`);
    const contentLen = parseInt(resp.headers.get('content-length')||'0');
    let loaded = 0;
    const reader = resp.body.getReader(), chunks = [];
    while (true) {
      const {done, value} = await reader.read();
      if (done) break;
      chunks.push(value); loaded += value.length;
      if (contentLen > 0) {
        const pct = Math.round(loaded/contentLen*100);
        document.getElementById('hfDlFill').style.width = pct + '%';
        document.getElementById('hfStatusText').textContent =
          `Downloading ${formatBytes(loaded)} / ${formatBytes(contentLen)} (${pct}%)`;
      } else {
        document.getElementById('hfStatusText').textContent = `Downloading ${formatBytes(loaded)}â€¦`;
      }
    }
    const total = chunks.reduce((s,c)=>s+c.length,0);
    const buf   = new Uint8Array(total);
    let off = 0; for (const c of chunks) { buf.set(c,off); off+=c.length; }
    _hfBuffer = buf.buffer;
    showHFStatus('ok', `âœ“ Downloaded ${formatBytes(total)} â€” ready to convert`, false);
    // Auto-fetch tokenizer
    try {
      const tr = await fetch(`${base}/${model.tok||'tokenizer.json'}`);
      if (tr.ok) {
        _tokContent = await tr.text();
        document.getElementById('tokDropText').textContent = 'âœ“ tokenizer.json fetched from HuggingFace';
        document.getElementById('tokDrop').classList.add('loaded');
      }
    } catch {}
  } catch(e) {
    showHFStatus('err', 'âŒ ' + e.message);
  } finally {
    btn.disabled = false; btn.innerHTML = '<span class="material-icons-round">download</span> Load from HF';
  }
};

function showHFStatus(type, text, showBar=false) {
  const el = document.getElementById('hfStatus');
  el.className = 'hf-status visible' + (type==='ok'?' ok':type==='err'?' err':'');
  document.getElementById('hfStatusIcon').textContent = type==='ok'?'check_circle':type==='err'?'error':'hourglass_empty';
  document.getElementById('hfStatusText').textContent = text;
  const bar = document.getElementById('hfDlProgress');
  bar.style.display = showBar ? 'block' : 'none';
  if (showBar) document.getElementById('hfDlFill').style.width = '0%';
}

// â”€â”€ File upload â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const dz = document.getElementById('dropZone'), fi = document.getElementById('fileInput');
dz.addEventListener('dragover', e=>{e.preventDefault();dz.classList.add('drag-over')});
dz.addEventListener('dragleave', ()=>dz.classList.remove('drag-over'));
dz.addEventListener('drop', e=>{e.preventDefault();dz.classList.remove('drag-over');const f=e.dataTransfer.files[0];if(f)setFile(f)});
fi.addEventListener('change', ()=>{if(fi.files[0])setFile(fi.files[0])});
function setFile(f) {
  _file = f;
  document.getElementById('dropFileName').style.display = 'flex';
  document.getElementById('dropFileNameText').textContent = `${f.name} (${formatBytes(f.size)})`;
  document.getElementById('modelName').value = f.name.replace('.safetensors','').replace(/[^a-zA-Z0-9-_]/g,'-').toLowerCase();
}

// â”€â”€ Tokenizer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const td=document.getElementById('tokDrop'), ti=document.getElementById('tokInput');
td.addEventListener('dragover',e=>e.preventDefault());
td.addEventListener('drop',e=>{e.preventDefault();const f=e.dataTransfer.files[0];if(f)setTok(f)});
ti.addEventListener('change',()=>{if(ti.files[0])setTok(ti.files[0])});
function setTok(f) {
  const r=new FileReader(); r.onload=()=>{
    _tokContent=r.result;
    td.classList.add('loaded');
    document.getElementById('tokDropText').textContent=`âœ“ ${f.name} loaded`;
  }; r.readAsText(f);
}

// â”€â”€ Conversion â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.startConversion = async function() {
  let buffer = null;
  if (_sourceMode==='hf') {
    if (!_hfBuffer) { alert('Please load a model from HuggingFace first.'); return; }
    buffer = _hfBuffer;
  } else {
    if (!_file) { alert('Please upload a .safetensors file first.'); return; }
    buffer = await _file.arrayBuffer();
  }
  const btn   = document.getElementById('convBtn');
  const preset = PRESETS[_activePreset] || {};
  const quant  = document.getElementById('quantMode').value;
  const shard  = parseInt(document.getElementById('shardSize').value);
  const arch   = document.getElementById('archOverride').value;
  btn.disabled=true; btn.innerHTML='<span class="material-icons-round">hourglass_empty</span> Convertingâ€¦';
  document.getElementById('progressSection').classList.add('visible');
  document.getElementById('resultSection').classList.remove('visible');
  document.getElementById('progressLog').innerHTML='';

  function onProgress(pct, msg) {
    document.getElementById('convProgressFill').style.width = pct+'%';
    document.getElementById('convStatus').textContent = msg;
    document.getElementById('convPct').textContent = pct+'%';
    const log=document.getElementById('progressLog');
    const line=document.createElement('div'); line.className='log-line';
    line.innerHTML=`<span class="log-pct">${pct}%</span><span class="log-msg">${msg}</span>`;
    log.appendChild(line); log.scrollTop=log.scrollHeight;
  }

  try {
    _bundle = await convertSafetensors(buffer, {
      quantMode: quant,
      shardSizeBytes: shard,
      onProgress,
      configOverrides: arch ? { arch } : {},
      tokenizerJson: _tokContent,
      kernelsSrc: _kernelsSrc,
      // Extreme-speed optimization flags
      optimized: true,
      blockSize: quant === 'q4' ? 64 : 32,
      calibrateBlocks: true,
    });

    const m=_bundle.manifest, c=_bundle.config;
    document.getElementById('resArch').innerHTML     = `${c.arch} <span class="arch-badge">${m.quant.toUpperCase()}</span>`;
    document.getElementById('resTensors').textContent = m.tensor_count;
    document.getElementById('resShards').textContent  = m.num_shards;
    document.getElementById('resQuant').textContent   = m.quant.toUpperCase() + (preset.accuracyNote ? ' â€” ' + preset.accuracyNote : '');
    document.getElementById('resSize').textContent    = formatBytes(_bundle.shards.reduce((s,b)=>s+b.byteLength,0));
    const sr=document.getElementById('resSpeedRow');
    if (preset.speedEst) { document.getElementById('resSpeed').textContent=preset.speedEst; sr.style.display='flex'; }
    else sr.style.display='none';
    document.getElementById('resultSection').classList.add('visible');
    btn.innerHTML='<span class="material-icons-round">check_circle</span> Conversion complete!';
  } catch(err) {
    onProgress(0,'âŒ Error: '+err.message); console.error(err);
    btn.disabled=false; btn.innerHTML='<span class="material-icons-round">auto_fix_high</span> Retry';
  }
};

window.downloadModel = async function() {
  if (!_bundle) return;
  const name=document.getElementById('modelName').value||'model';
  try { await downloadBundle(_bundle,name); }
  catch(e) { if(e.name!=='AbortError') alert('Download failed: '+e.message); }
};

window.saveToOPFSModel = async function() {
  if (!_bundle) return;
  const name=document.getElementById('modelName').value||'model';
  const btn=document.getElementById('opfsBtn');
  btn.disabled=true; btn.innerHTML='<span class="material-icons-round">hourglass_empty</span> Savingâ€¦';
  try {
    await saveToOPFS(_bundle,name);
    btn.innerHTML='<span class="material-icons-round">check_circle</span> Saved!';
    btn.style.color='var(--green)';
  } catch(e) {
    alert('OPFS save failed: '+e.message);
    btn.disabled=false; btn.innerHTML='<span class="material-icons-round">save</span> Save to browser cache';
  }
};

function formatBytes(b) {
  if(b>=1e9) return (b/1e9).toFixed(2)+' GB';
  if(b>=1e6) return (b/1e6).toFixed(1)+' MB';
  if(b>=1e3) return (b/1e3).toFixed(0)+' KB';
  return b+' B';
}
</script>
</body>
</html>
